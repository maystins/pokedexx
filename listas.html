<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pokedéx</title>
	<!-- fontes usadas no Index.html -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Shrikhand&family=Archivo+Black&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Poppins', sans-serif;
			margin: 20px;
			background: #f9f9f9;
		}
		h1 {
			color: #a52a2a;
			text-align: center;
		}
		.search-box {
			display: flex;
			justify-content: center;
			margin: 20px auto;
			gap: 10px;
		}
		.sr-only{ position: absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0 }
		.search-btn svg{ width:18px; height:18px; display:block }
		.search-box input {
			padding: 8px;
			width: 200px;
			border: 1px solid #aaa;
			border-radius: 8px;
			outline: none;
		}
		.search-box button {
			/* mantem botao minimo */
			background: transparent;
			color: inherit;
			border: none;
			padding: 6px;
			border-radius: 6px;
			cursor: pointer;
		}
		.search-box button:hover { background: rgba(0,0,0,0.03); }
		.search-btn{ background:transparent; border:none; padding:6px; border-radius:6px; cursor:pointer }
		.search-btn:focus{ outline:none; box-shadow:none }
		.pokemon-container {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
			gap: 20px;
			margin-top: 20px;
		}
		.pokemon-card {
			background: white;
			border-radius: 12px;
			padding: 12px;
			text-align: center;
			box-shadow: 0 6px 18px rgba(0,0,0,0.08);
			cursor: pointer;
			transition: transform .16s ease, box-shadow .16s ease;
			position: relative; /* botao de fav */
		}
		.pokemon-card:hover { transform: translateY(-6px); box-shadow: 0 12px 30px rgba(0,0,0,0.12); }
		.pokemon-card img {
			width: 120px;
			height: 120px;
			object-fit: contain;
		}
		.type-badges { display:flex; gap:6px; justify-content:center; margin-top:8px; flex-wrap:wrap }
		.type { padding:4px 8px; border-radius:12px; font-size:12px; color:#fff; font-weight:700; text-transform:capitalize }
	.fav-btn{ position:absolute; right:10px; top:10px; background:transparent; border:none; font-size:18px; cursor:pointer }
	.fav-btn.active{ filter: drop-shadow(0 4px 10px rgba(229,57,53,0.22)); }

		/* modal */
		.modal-overlay { position: fixed; inset:0; background: rgba(0,0,0,0.6); display:none; align-items:center; justify-content:center; z-index:1200 }
		.modal-overlay.show { display:flex }
	.modal-box { background:#fff; border-radius:12px; padding:14px; max-width:640px; width:auto; color:#222; box-shadow:0 12px 40px rgba(0,0,0,0.3); display:flex; gap:12px; align-items:flex-start; flex-wrap:wrap }
	.modal-left img{ width:170px }
	.modal-right{ flex:1; min-width:200px }
		.image-wrap{ position:relative; display:inline-block; border-radius:12px; overflow:visible }
		.image-wrap img{ display:block; border-radius:10px; position:relative; z-index:2 }
		/* vermelho atras da img */
		.image-wrap::before{
			content:''; position:absolute; left:-8px; right:-8px; top:-8px; bottom:-8px; z-index:1;
			background: radial-gradient(circle at 30% 20%, rgba(255,80,80,0.18), rgba(255,40,40,0.08) 20%, rgba(0,0,0,0.06) 60%, transparent 70%);
			filter: blur(18px);
			transform: translateZ(0);
			border-radius:14px;
		}
		.image-wrap::after{ /* sombra */
			content:''; position:absolute; inset:auto  -10px -12px -10px; height:40px; z-index:0; pointer-events:none;
			box-shadow: 0 18px 40px rgba(0,0,0,0.35);
			border-radius:50%;
			opacity:0.9;
			transform: translateY(6px);
		}
		.modal-right h3{ margin:0 0 6px 0 }
	.stats { display:flex; flex-direction:column; gap:10px; margin-top:12px; min-width:240px }
	.stat-row{ display:flex; gap:10px; align-items:center }
	.stat-label{ width:120px; font-weight:600; font-size:14px; color:#333 }
	.bar{ flex:1; background:#eee; height:14px; border-radius:10px; overflow:hidden; position:relative }
	.bar-fill{ height:100%; width:0%; background: linear-gradient(90deg,#ff6b6b,#ff3b3b); border-radius:10px; transition:width .9s cubic-bezier(.2,.9,.2,1) }
	.bar-value{ margin-left:8px; width:44px; text-align:right; font-weight:700; color:#222 }
		.abilities { margin-top:8px }
		.close-btn { position:absolute; right:18px; top:12px; background:transparent; border:none; font-size:20px; cursor:pointer }
	/* navbar */
	.topbar{ position:sticky; top:0; z-index:1100; background:linear-gradient(180deg, #fff, #fbfbfb); box-shadow:0 6px 18px rgba(25,25,25,0.07); display:flex; align-items:center; justify-content:space-between; padding:12px 18px; border-bottom: none }
	.brand{ display:flex; align-items:center; gap:10px; font-weight:800; color:#222 }
	.brand img{ width:36px; height:36px }
	.brand{ text-decoration:none }
	.brand span{ text-decoration:none }
	.nav-links{ display:flex; gap:18px; align-items:center }
	.nav-links a{ color:black; text-decoration:none; font-weight:400; padding:6px 8px; border-radius:6px; transition:color .18s ease, transform .18s ease }
	.nav-links a:hover{ color:#e53935; transform:scale(1.08) }
	.nav-links a.active{ color:#e53935 } /* letra fica vermelha quando ativo */

	/* titulo */
	.page-title{ font-family: 'Shrikhand', cursive; font-size:44px; margin:18px 0 6px 0; letter-spacing:1px; font-weight:900; color:#951c1c; text-shadow:0 6px 18px rgba(0,0,0,0.04) }
	.subtitle{ color:#666; margin:0 0 14px 0; text-align:center }
	.search-box button{ color:#e53935 }
	.brand span{ color:#000 }

/* listas */
.create-form{ display:flex; gap:8px; align-items:center; margin-bottom:18px; flex-wrap:wrap }
.create-form input, .create-form textarea{ padding:10px; border-radius:10px; border:1px solid #ececec; box-shadow:inset 0 1px 0 rgba(0,0,0,0.02); }
.create-form button{ background:linear-gradient(180deg,#ff6b6b,#e53935); color:#fff; border:none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700; box-shadow:0 8px 18px rgba(229,57,53,0.12) }
.lists-grid{ display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:18px }
.list-card{ background:linear-gradient(180deg,#fff,#fcfcfc); padding:14px; border-radius:14px; box-shadow:0 12px 30px rgba(0,0,0,0.06); min-height:120px; display:flex; flex-direction:column; justify-content:space-between; transition:transform .18s ease,box-shadow .18s ease }
.list-card:hover{ transform:translateY(-6px); box-shadow:0 20px 48px rgba(0,0,0,0.12) }
.list-card h3{ margin:0 0 6px 0; font-size:18px; color:#2b2b2b }
.list-card .meta{ color:#666; font-size:13px }
.list-actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:10px }
.btn-ghost{ background:#f4f4f6; border:none; padding:8px 10px; border-radius:10px; cursor:pointer; color:#333 }
.btn-ghost:hover{ background:#eee }
.btn-danger{ background:#e53935; color:#fff; border:none; padding:8px 10px; border-radius:10px; cursor:pointer }
.btn-danger:hover{ filter:brightness(0.95) }
.btn-primary{ background:#2b7a78; color:#fff; border:none; padding:8px 10px; border-radius:10px; cursor:pointer }
.grid-items{ display:grid; grid-template-columns: repeat(auto-fit,minmax(160px,1fr)); gap:12px }
.poke-tile{ background:#ffffff; border-radius:12px; padding:10px; text-align:center; box-shadow:0 8px 20px rgba(0,0,0,0.04) }
.poke-tile img{ width:96px; height:96px; object-fit:contain }
.empty{ color:#666; text-align:center; padding:30px }
	/* filters */
	.type-filters{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin:8px 0 12px 0 }
	.filter-type-btn{ border:none; padding:6px 10px; border-radius:999px; cursor:pointer; font-weight:700; color:#fff; transition:transform .12s ease, box-shadow .12s ease }
	.filter-type-btn.active{ box-shadow: 0 8px 24px rgba(229,57,53,0.12); transform:scale(1.04) }
	.clear-filter{ background:transparent; border:1px solid #e53935; color:#e53935; padding:6px 10px; border-radius:8px; cursor:pointer; font-weight:700 }
	/* spinner */
	.spinner{ position:fixed; right:18px; bottom:18px; width:56px; height:56px; border-radius:50%; display:flex; align-items:center; justify-content:center; z-index:1300 }
	.spinner .ring{ width:44px; height:44px; border:4px solid rgba(229,57,53,0.12); border-top-color: #e53935; border-radius:50%; animation:spin 1s linear infinite }
	.spinner.hidden{ display:none }
	@keyframes spin{ to{ transform:rotate(360deg) } }
	</style>
</head>
<body>
	<header class="topbar">
		<a href="Index.html" class="brand" aria-label="Voltar para Início"><img src="pokebola.png" alt="pokebola"><span>Pokédex</span></a>
		<nav class="nav-links" aria-label="Principal">
			<a href="Index.html" class="nav-home">Início</a>
			<a href="pokedex.html#favorites" class="nav-fav">Favoritos</a>
			<a href="listas.html" class="nav-lists active">Listas</a>
		</nav>
	</header>

	<main>
		<h1 class="page-title">Minhas listas</h1>
		<p class="subtitle">Aqui estão as listas que você criou. Você pode editar, excluir ou abrir para ver os Pokémons.</p>

		<div style="max-width:900px;margin:0 auto 18px auto">
			<form id="create-list-form" class="create-form" onsubmit="return false;">
				<input id="list-name" placeholder="Nome da lista" aria-label="Nome da lista" required style="min-width:200px" />
				<input id="list-desc" placeholder="Descrição (opcional)" aria-label="Descrição da lista" style="min-width:280px" />
				<button id="create-list">Criar lista</button>
			</form>
		</div>

		<section id="lists-section">
			<div id="lists-empty" class="empty" style="display:none">Você ainda não criou listas.</div>
			<div id="lists-grid" class="lists-grid"></div>
		</section>

		<section id="list-detail-wrap" style="margin-top:18px"></section>
	</main>

	<!-- Spinner p loading -->
	<div id="global-spinner" class="spinner hidden" aria-hidden="true" aria-live="polite"><div class="ring" aria-hidden="true"></div></div>

	<div class="modal-overlay" id="poke-modal" aria-hidden="true">
		<div class="modal-box" role="dialog" aria-modal="true" aria-label="Detalhes do Pokémon">
			<button class="close-btn" aria-label="Fechar">✕</button>
			<div class="modal-left"><div class="image-wrap"><img src="pokemon.png" alt="pokemon"></div></div>
			<div class="modal-right">
				<h3>Nome</h3>
				<div class="type-badges"></div>
				<div class="stats"></div>
				<div class="abilities"></div>
			</div>
		</div>
	</div>

	<script>
		// reutiliza msm localStorage usada na pag da pokedex 
		const LISTS_KEY = 'pokedex_lists_v1';
		let lists = {};

		function loadLists(){ try{ lists = JSON.parse(localStorage.getItem(LISTS_KEY) || '{}'); }catch(e){ lists = {}; } renderLists(); }
		function saveLists(){ localStorage.setItem(LISTS_KEY, JSON.stringify(lists)); renderLists(); }

		function createList(name, description){ if(!name || !name.trim()) return null; const id = 'list_' + Date.now(); lists[id] = { id, name: name.trim(), description: (description||'').trim(), items: [] }; saveLists(); return lists[id]; }
		function editList(id, name, description){ if(!lists[id]) return; if(name && name.trim()) lists[id].name = name.trim(); lists[id].description = description ? description.trim() : ''; saveLists(); }
		function deleteList(id){ if(!lists[id]) return; delete lists[id]; saveLists(); }
		function addPokemonToList(listId, poke){ if(!lists[listId]) return; const exists = lists[listId].items.find(i=> String(i.id) === String(poke.id)); if(exists) return; lists[listId].items.push({ id: poke.id, name: poke.name, img: (poke.sprites && (poke.sprites.other && poke.sprites.other['official-artwork'] && poke.sprites.other['official-artwork'].front_default)) || poke.sprites?.front_default || poke.img || 'pokemon.png' }); saveLists(); }
		function removePokemonFromList(listId, pokeId){ if(!lists[listId]) return; lists[listId].items = (lists[listId].items||[]).filter(i => String(i.id) !== String(pokeId)); saveLists(); }

		function renderLists(){
			const grid = document.getElementById('lists-grid');
			const empty = document.getElementById('lists-empty');
			grid.innerHTML = '';
			const keys = Object.keys(lists||{});
			if(!keys.length){ empty.style.display = 'block'; return; } else empty.style.display='none';
			keys.forEach(k=>{
				const l = lists[k];
				const card = document.createElement('div'); card.className = 'list-card';
				const desc = l.description ? `<div class="meta small">${escapeHtml(l.description)}</div>` : '';
				const preview = (l.items||[]).slice(0,4).map(it=> `<div style="display:inline-block;margin-right:6px;color:#444">${escapeHtml(it.name)}</div>`).join('');
				card.innerHTML = `<div><h3>${escapeHtml(l.name)}</h3>${desc}<div style="margin-top:8px" class="small">${preview || '<em>Nenhum Pokémon</em>'}</div></div>`;
				const actions = document.createElement('div'); actions.className='list-actions';
				const openBtn = document.createElement('button'); openBtn.className='btn-ghost'; openBtn.textContent='Abrir'; openBtn.addEventListener('click', ()=> showListDetail(l.id));
				const editBtn = document.createElement('button'); editBtn.className='btn-ghost'; editBtn.textContent='Editar'; editBtn.addEventListener('click', ()=>{ const n = prompt('Novo nome da lista', l.name); if(n===null) return; const d = prompt('Nova descrição (opcional)', l.description||''); editList(l.id,n,d); });
				const delBtn = document.createElement('button'); delBtn.className='btn-danger'; delBtn.textContent='Excluir'; delBtn.addEventListener('click', ()=>{ const ok = confirm(`Excluir lista "${l.name}"? Esta ação não pode ser desfeita.`); if(!ok) return; deleteList(l.id); });
				actions.appendChild(openBtn); actions.appendChild(editBtn); actions.appendChild(delBtn);
				card.appendChild(actions);
				grid.appendChild(card);
			});
		}

		function showListDetail(listId){ const wrap = document.getElementById('list-detail-wrap'); wrap.innerHTML = ''; const l = lists[listId]; if(!l) return; const detail = document.createElement('div'); detail.className='detail-view'; detail.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px"><div><h3 style="margin:0">${escapeHtml(l.name)}</h3><div class="small meta">${l.description||'<em>Sem descrição</em>'}</div></div><div><button id="back-to-lists" class="btn-ghost">Voltar</button><button id="delete-list" class="btn-danger">Excluir lista</button></div></div><div id="list-items" class="grid-items"></div>`;
			wrap.appendChild(detail);
			const itemsWrap = detail.querySelector('#list-items');
			(l.items||[]).forEach(it=>{
				const tile = document.createElement('div'); tile.className='poke-tile';
				// adiciona data attributes para facilitar pegar id/nome depois
				tile.dataset.pokeId = String(it.id);
				tile.dataset.pokeName = String(it.name || '');
				tile.innerHTML = `<img src="${escapeHtml(it.img)}" alt="${escapeHtml(it.name)}"><div style="font-weight:700;margin-top:8px">${escapeHtml(it.name)}</div><div style="margin-top:8px"><button class="btn-danger remove-item">Remover</button></div>`;
				itemsWrap.appendChild(tile);
				const rm = tile.querySelector('.remove-item'); rm.addEventListener('click', ()=>{ removePokemonFromList(listId, it.id); showListDetail(listId); });
			});
			detail.querySelector('#back-to-lists').addEventListener('click', ()=> { wrap.innerHTML=''; });
			detail.querySelector('#delete-list').addEventListener('click', ()=>{ const ok = confirm(`Excluir lista "${l.name}"? Esta ação não pode ser desfeita.`); if(!ok) return; deleteList(l.id); wrap.innerHTML=''; });
		}

		// permite clicar em tiles p ver detalhes
		function setupListTileDetails(){
			// delega cliques p container
			const wrap = document.getElementById('list-detail-wrap');
			if(!wrap) return;
			wrap.addEventListener('click', async (e)=>{
				const tile = e.target.closest('.poke-tile');
				if(!tile) return;
				// se o clique foi no botao de remover, ignora
				if(e.target.closest('.remove-item')) return;
				const pid = tile.dataset.pokeId || tile.getAttribute('data-poke-id');
				if(!pid) return;
				try{
					showSpinner();
					const resp = await fetch(`https://pokeapi.co/api/v2/pokemon/${pid}`);
					if(resp.ok){ const full = await resp.json(); showModal(full); }
					else { 
						const name = tile.dataset.pokeName || tile.querySelector('div') && tile.querySelector('div').textContent || 'Pokémon';
						showModal({ id: pid, name: name.toString().toLowerCase(), stats: [], types: [], abilities: [] });
					}
				}catch(err){
					console.error('Erro ao carregar detalhes do Pokémon', err);
				}finally{ hideSpinner(); }
			});
		}

		// copiadas da pag da pokedex p reaproveitar
		const typeNamePT = (name) => {
		  const map = { fire:'Fogo', water:'Água', grass:'Grama', electric:'Elétrico',
		    poison:'Veneno', rock:'Pedra', ground:'Terra', bug:'Inseto', dragon:'Dragão',
		    psychic:'Psíquico', fairy:'Fada', fighting:'Lutador', normal:'Normal',
		    ghost:'Fantasma', steel:'Aço', ice:'Gelo', flying:'Voador', dark:'Sombrio'};
		  return map[name] || name.charAt(0).toUpperCase()+name.slice(1);
		};

		function getTypeColor(name){
		  const colors = { fire:'#F08030', water:'#6890F0', grass:'#78C850', electric:'#F8D030',
		    poison:'#A040A0', rock:'#B8A038', ground:'#E0C068', bug:'#A8B820',
		    dragon:'#7038F8', psychic:'#F85888', fairy:'#EE99AC', fighting:'#C03028',
		    normal:'#A8A878', ghost:'#705898', steel:'#B8B8D0', ice:'#98D8D8', flying:'#A890F0', dark:'#705848'};
		  return colors[name] || '#666';
		}

		function getPokemonImage(poke){
		  try{
		    const id = poke && (poke.id || (poke.url && poke.url.split('/').filter(Boolean).pop()));
		    const s = poke && poke.sprites ? poke.sprites : {};
		    const other = s.other || {};
		    const candidates = [];
		    if(other['official-artwork'] && other['official-artwork'].front_default) candidates.push(other['official-artwork'].front_default);
		    if(other.home && other.home.front_default) candidates.push(other.home.front_default);
		    if(other['dream_world'] && other['dream_world'].front_default) candidates.push(other['dream_world'].front_default);
		    if(s.front_default) candidates.push(s.front_default);
		    if(poke && poke.img) candidates.push(poke.img);
		    if(id){
		      candidates.push(`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${id}.png`);
		      candidates.push(`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${id}.png`);
		    }
		    candidates.push('pokemon.png');
		    return { url: candidates[0], fallbacks: candidates.slice(1) };
		  }catch(e){ return { url: 'pokemon.png', fallbacks: [] }; }
		}

		function animateNumber(el, start, end, duration){
		  const startTime = performance.now();
		  const step = (now)=>{
		    const t = Math.min(1, (now - startTime) / duration);
		    const eased = t<0.5 ? 2*t*t : -1 + (4-2*t)*t; // easeInOut approx
		    const value = Math.round(start + (end - start) * eased);
		    el.textContent = value;
		    if(t < 1) requestAnimationFrame(step);
		  };
		  requestAnimationFrame(step);
		}

		// spinner controla a visibilidade
		let _spinnerRef = 0;
		function showSpinner(){
		  _spinnerRef = Math.max(0, _spinnerRef) + 1;
		  const el = document.getElementById('global-spinner');
		  if(el){ el.classList.remove('hidden'); el.setAttribute('aria-hidden','false'); }
		}
		function hideSpinner(){
		  _spinnerRef = Math.max(0, _spinnerRef - 1);
		  if(_spinnerRef <= 0){ const el = document.getElementById('global-spinner'); if(el){ el.classList.add('hidden'); el.setAttribute('aria-hidden','true'); } _spinnerRef = 0; }
		}

		// modal setup 
		(function setupModal(){
		  const modalOverlay = document.getElementById('poke-modal');
		  if(!modalOverlay) return;
		  modalOverlay.addEventListener('click', e => { if(e.target === modalOverlay || e.target.classList.contains('close-btn')) closeModal(); });
		  function closeModal(){ modalOverlay.classList.remove('show'); modalOverlay.setAttribute('aria-hidden','true'); }
		  window._closeModal = closeModal;
		})();

		function showModal(poke){
		  const modalOverlay = document.getElementById('poke-modal');
		  if(!modalOverlay) return;
		  const imgEl = modalOverlay.querySelector('.modal-left img');
		  const nameEl = modalOverlay.querySelector('.modal-right h3');
		  const badgesEl = modalOverlay.querySelector('.modal-right .type-badges');
		  const statsEl = modalOverlay.querySelector('.modal-right .stats');
		  const abilitiesEl = modalOverlay.querySelector('.modal-right .abilities');
		  const imgInfo = getPokemonImage(poke);
		  imgEl.src = imgInfo.url; imgEl.alt = poke.name;
		  if(imgInfo.fallbacks && imgInfo.fallbacks.length){ imgEl.dataset.fallbacks = JSON.stringify(imgInfo.fallbacks); imgEl.addEventListener('error', function onModalErr(){ try{ const list = JSON.parse(this.dataset.fallbacks||'[]'); if(list && list.length){ const next = list.shift(); this.dataset.fallbacks = JSON.stringify(list); this.src = next; } else { this.removeEventListener('error', onModalErr); this.src = 'pokemon.png'; } }catch(e){ this.src='pokemon.png'; } }); }
		  nameEl.textContent = `${poke.name.charAt(0).toUpperCase()+poke.name.slice(1)}  #${poke.id}`;
		  badgesEl.innerHTML = (poke.types || []).map(t=> `<span class="type" style="background:${getTypeColor(t.type ? t.type.name : t)}">${typeNamePT(t.type ? t.type.name : t)}</span>`).join('');
		  const statNames = { 'hp':'Vida', 'attack':'Ataque', 'defense':'Defesa', 'speed':'Velocidade', 'special-attack':'Ataque Especial', 'special-defense':'Defesa Especial' };
		  statsEl.innerHTML = '';
		  (poke.stats || []).forEach((s, idx)=>{
		    const row = document.createElement('div'); row.className = 'stat-row';
		    const label = document.createElement('div'); label.className='stat-label'; label.textContent = statNames[s.stat.name] || s.stat.name.toUpperCase();
		    const barWrap = document.createElement('div'); barWrap.className='bar';
		    const fill = document.createElement('div'); fill.className='bar-fill'; fill.style.width = '0%'; fill.setAttribute('aria-valuenow', '0');
		    barWrap.appendChild(fill);
		    const val = document.createElement('div'); val.className='bar-value'; val.textContent = '0';
		    row.appendChild(label); row.appendChild(barWrap); row.appendChild(val);
		    statsEl.appendChild(row);
		    const percent = Math.round((s.base_stat / 255) * 100);
		    setTimeout(()=>{ fill.style.width = percent + '%'; fill.setAttribute('aria-valuenow', s.base_stat); animateNumber(val, 0, s.base_stat, 900); }, 120 * idx + 80);
		  });
		  const habilidadesTraduzidas = (poke.abilities||[]).map(a=> prettifyAbility(a.ability ? a.ability.name : a)).join(', ');
		  abilitiesEl.innerHTML = `<strong>Habilidades:</strong> ${habilidadesTraduzidas}`;
		  modalOverlay.classList.add('show'); modalOverlay.setAttribute('aria-hidden','false');
		}

		function prettifyAbility(name){
		  const map = { 'overgrow':'Overgrow', 'blaze':'Blaze', 'torrent':'Torrent', 'shield-dust':'Pó Protetor',
		    'run-away':'Fuga', 'intimidate':'Intimidação', 'keen-eye':'Visão Aguçada' };
		  if(map[name]) return map[name];
		  return name.split(/[-_ ]+/).map(w => w.charAt(0).toUpperCase()+w.slice(1)).join(' ');
		}

	
		setupListTileDetails();

		function escapeHtml(s){ return (s||'').toString().replace(/[&<>\"']/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',"'":"&#39;"}[c]; }); }

		// eventos
		document.getElementById('create-list').addEventListener('click', ()=>{
			const name = document.getElementById('list-name').value && document.getElementById('list-name').value.trim();
			const desc = document.getElementById('list-desc').value && document.getElementById('list-desc').value.trim();
			if(!name) return alert('Nome da lista é obrigatório');
			createList(name, desc);
			document.getElementById('list-name').value=''; document.getElementById('list-desc').value='';
		});

		// init
		loadLists();
	</script>
</body>
</html>